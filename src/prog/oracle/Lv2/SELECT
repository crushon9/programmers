-- 3월에 태어난 여성 회원 목록 출력하기
SELECT MEMBER_ID,MEMBER_NAME,GENDER
,TO_CHAR(DATE_OF_BIRTH,'YYYY-MM-DD') AS DATE_OF_BIRTH
FROM MEMBER_PROFILE
WHERE TLNO IS NOT NULL
AND SUBSTR(TO_CHAR(DATE_OF_BIRTH,'YYYY-MM-DD'),6,2) = '03'
AND GENDER = 'W'
ORDER BY MEMBER_ID;

-- 재구매가 일어난 상품과 회원 리스트 구하기
SELECT USER_ID, PRODUCT_ID
FROM ONLINE_SALE
HAVING COUNT(*) > 1
GROUP BY USER_ID, PRODUCT_ID
ORDER BY USER_ID, PRODUCT_ID DESC;

-- 자동차 평균 대여 기간 구하기
SELECT
CAR_ID , ROUND(AVG(END_DATE - START_DATE+1),1) AS AVERAGE_DURATION
FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY
GROUP BY CAR_ID
HAVING ROUND(AVG(END_DATE - START_DATE+1),1) >= 7
ORDER BY AVERAGE_DURATION DESC, CAR_ID DESC;
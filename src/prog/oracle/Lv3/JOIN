-- 오랜 기간 보호한 동물(1)
SELECT I.NAME,I.DATETIME
FROM ANIMAL_INS I
LEFT JOIN ANIMAL_OUTS O
ON I.ANIMAL_ID = O.ANIMAL_ID
WHERE O.DATETIME IS NULL
ORDER BY I.DATETIME
FETCH FIRST 3 ROWS ONLY;


-- 없어진 기록 찾기
SELECT o.ANIMAL_ID, o.NAME
FROM ANIMAL_OUTS o
LEFT OUTER JOIN ANIMAL_INS i
ON o.ANIMAL_ID = i.ANIMAL_ID
WHERE i.DATETIME IS NULL
ORDER BY o.ANIMAL_ID;


-- 있었는데요 없었습니다
SELECT o.ANIMAL_ID, o.NAME
FROM ANIMAL_OUTS o
LEFT OUTER JOIN ANIMAL_INS i
ON o.ANIMAL_ID = i.ANIMAL_ID
WHERE i.DATETIME > o.DATETIME
ORDER BY i.DATETIME;


-- 오랜 기간 보호한 동물(2)
-- 알게된점 : ORDER BY에 연산도 가능하구나
입양을 간 동물 중, 보호 기간이 가장 길었던 동물 두 마리의 아이디와 이름을 조회하는 SQL문을 작성해주세요.
이때 결과는 보호 기간이 긴 순으로 조회해야 합니다.
SELECT o.ANIMAL_ID, o.NAME
FROM ANIMAL_OUTS o
INNER JOIN ANIMAL_INS i
ON o.ANIMAL_ID = i.ANIMAL_ID
ORDER BY o.DATETIME-i.DATETIME DESC
FETCH FIRST 2 ROWS ONLY;


-- 대여 기록이 존재하는 자동차 리스트 구하기
SELECT DISTINCT
    H.CAR_ID
FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY H
INNER JOIN CAR_RENTAL_COMPANY_CAR C
ON H.CAR_ID = C.CAR_ID
AND C.CAR_TYPE = '세단'
WHERE TO_CHAR(H.START_DATE,'MM') = '10'
ORDER BY CAR_ID DESC;
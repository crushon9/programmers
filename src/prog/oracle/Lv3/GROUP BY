-- 즐겨찾기가 가장 많은 식당 정보 출력하기
-- GROUP BY는 함수로 조건을 주지 않으면 첫번째 행의 값을 가져온다
-- MAX(FAVORITES) 는 최대값을 가져오지만 FOOD_TYPE 은 제일 위의 값을 가져온다
SELECT R.FOOD_TYPE, R.REST_ID, R.REST_NAME, R.FAVORITES
FROM REST_INFO R
INNER JOIN
(SELECT FOOD_TYPE, MAX(FAVORITES) AS FAVORITES
            FROM REST_INFO
            GROUP BY FOOD_TYPE) a
ON a.FOOD_TYPE = R.FOOD_TYPE
AND a.FAVORITES = R.FAVORITES
ORDER BY R.FOOD_TYPE DESC;


-- 헤비 유저가 소유한 장소
-- GROUP BY로 안 묶인 컬럼을 SELECT 하면 'GROUP BY 표현식이 아닙니다' 에러
SELECT * FROM PLACES
WHERE HOST_ID IN (SELECT HOST_ID
FROM PLACES
GROUP BY HOST_ID
HAVING COUNT(*) > 1)
ORDER BY ID;


-- 식품분류별 가장 비싼 식품의 정보 조회하기
SELECT R.CATEGORY, R.PRICE, R.PRODUCT_NAME
FROM FOOD_PRODUCT R
INNER JOIN
(SELECT CATEGORY, MAX(PRICE) AS PRICE
            FROM FOOD_PRODUCT
            GROUP BY CATEGORY) a
ON a.CATEGORY = R.CATEGORY
AND a.PRICE = R.PRICE
WHERE R.CATEGORY IN ('과자', '국', '김치', '식용유')
ORDER BY R.PRICE DESC;
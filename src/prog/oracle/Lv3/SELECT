-- 오랜 기간 보호한 동물(1)
SELECT I.NAME,I.DATETIME
FROM ANIMAL_INS I
LEFT JOIN ANIMAL_OUTS O
ON I.ANIMAL_ID = O.ANIMAL_ID
WHERE O.DATETIME IS NULL
ORDER BY I.DATETIME
FETCH FIRST 3 ROWS ONLY;

-- 즐겨찾기가 가장 많은 식당 정보 출력하기
SELECT R.FOOD_TYPE, R.REST_ID, R.REST_NAME, R.FAVORITES
FROM REST_INFO R
INNER JOIN
 -- 주의 할점 : GROUP BY는 함수로 조건을 주지 않으면 첫번째 행의 값을 가져온다
 -- MAX(FAVORITES) 는 최대값을 가져오지만 FOOD_TYPE은 제일 위의 값을 가져온다
(SELECT FOOD_TYPE, MAX(FAVORITES) AS FAVORITES
            FROM REST_INFO
            GROUP BY FOOD_TYPE) a
ON a.FOOD_TYPE = R.FOOD_TYPE
AND a.FAVORITES = R.FAVORITES
ORDER BY R.FOOD_TYPE DESC;

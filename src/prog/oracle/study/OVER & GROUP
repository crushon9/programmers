-- OVER(PARTITION BY) 윈도우 함수는 행의 개수, 선택할 수 있는 컬럼에 영향을 주지 않는다
SELECT ENAME
	 , JOB
     , SAL
     , MIN(SAL) OVER(PARTITION BY JOB) SAL_MIN
     , MAX(SAL) OVER(PARTITION BY JOB) SAL_MAX
 FROM EMP
 ORDER BY SAL DESC;

-- GROUP BY 는 행의 개수가 달라지며, GROUP BY로 묶인 컬럼이나 집계함수만 SELECT 할 수 있다
SELECT JOB
     , MIN(SAL) SAL_MIN
     , MAX(SAL) SAL_MAX
 FROM EMP
 GROUP BY JOB;

-- GROUP BY 로 문자열 합치기
SELECT JOB
     , LISTAGG(ENAME, ',') WITHIN GROUP(ORDER BY ENAME) AS ENAMES
  FROM EMP
 WHERE JOB IN ('MANAGER', 'SALESMAN')
 GROUP BY JOB;

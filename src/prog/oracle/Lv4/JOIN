-- 보호소에서 중성화한 동물
SELECT o.ANIMAL_ID, o.ANIMAL_TYPE, o.NAME
FROM ANIMAL_OUTS o
INNER JOIN ANIMAL_INS i
ON o.ANIMAL_ID = i.ANIMAL_ID
AND I.SEX_UPON_INTAKE LIKE 'Intact%'
WHERE O.SEX_UPON_OUTCOME LIKE 'Spayed%'
OR O.SEX_UPON_OUTCOME LIKE 'Neutered%'
ORDER BY o.ANIMAL_ID;

-- 5월 식품들의 총매출 조회하기
SELECT R.PRODUCT_ID, R.PRODUCT_NAME, a.AMOUNT * R.PRICE AS TOTAL_SALES
FROM FOOD_PRODUCT R
INNER JOIN
(SELECT PRODUCT_ID, SUM(AMOUNT) AS AMOUNT
            FROM FOOD_ORDER
            WHERE TO_CHAR(PRODUCE_DATE,'YYYYMM') = '202205'
            GROUP BY PRODUCT_ID) a
ON a.PRODUCT_ID = R.PRODUCT_ID
ORDER BY a.AMOUNT * R.PRICE DESC, R.PRODUCT_ID;
-- 보호소에서 중성화한 동물
SELECT o.ANIMAL_ID, o.ANIMAL_TYPE, o.NAME
FROM ANIMAL_OUTS o
INNER JOIN ANIMAL_INS i
ON o.ANIMAL_ID = i.ANIMAL_ID
AND I.SEX_UPON_INTAKE LIKE 'Intact%'
WHERE O.SEX_UPON_OUTCOME LIKE 'Spayed%'
OR O.SEX_UPON_OUTCOME LIKE 'Neutered%'
ORDER BY o.ANIMAL_ID;


-- 5월 식품들의 총매출 조회하기
SELECT R.PRODUCT_ID, R.PRODUCT_NAME, a.AMOUNT * R.PRICE AS TOTAL_SALES
FROM FOOD_PRODUCT R
INNER JOIN
(SELECT PRODUCT_ID, SUM(AMOUNT) AS AMOUNT
            FROM FOOD_ORDER
            WHERE TO_CHAR(PRODUCE_DATE,'YYYYMM') = '202205'
            GROUP BY PRODUCT_ID) a
ON a.PRODUCT_ID = R.PRODUCT_ID
ORDER BY a.AMOUNT * R.PRICE DESC, R.PRODUCT_ID;


-- 취소되지 않은 진료 예약 조회하기
SELECT
    A.APNT_NO,
    P.PT_NAME,
    P.PT_NO,
    A.MCDP_CD,
    D.DR_NAME,
    A.APNT_YMD
FROM APPOINTMENT A
INNER JOIN PATIENT P
ON A.PT_NO = P.PT_NO
INNER JOIN DOCTOR D
ON A.MDDR_ID = D.DR_ID
WHERE A.APNT_CNCL_YN = 'N'
AND A.MCDP_CD = 'CS'
AND TO_CHAR(A.APNT_YMD,'YYYYMMDD') = '20220413'
ORDER BY A.APNT_YMD;


-- 우유와 요거트가 담긴 장바구니
SELECT A.CART_ID
FROM (SELECT CART_ID
     FROM CART_PRODUCTS
     WHERE NAME = 'Milk') A
INNER JOIN (SELECT CART_ID
            FROM CART_PRODUCTS
            WHERE NAME = 'Yogurt') B
ON A.CART_ID = B.CART_ID
ORDER BY A.CART_ID;


-- 주문량이 많은 아이스크림들 조회하기
7월 아이스크림 총 주문량과 상반기의 아이스크림 총 주문량을 더한 값이 큰 순서대로 상위 3개의 맛을 조회하는 SQL 문을 작성해주세요.
SELECT H.FLAVOR
FROM(
SELECT FLAVOR, SUM(TOTAL_ORDER) AS TOTAL_ORDER
FROM FIRST_HALF
GROUP BY FLAVOR) H
LEFT JOIN(
SELECT FLAVOR, SUM(TOTAL_ORDER) AS TOTAL_ORDER
FROM JULY
GROUP BY FLAVOR) J
ON H.FLAVOR = J.FLAVOR
ORDER BY (H.TOTAL_ORDER + J.TOTAL_ORDER) DESC
FETCH FIRST 3 ROWS ONLY;